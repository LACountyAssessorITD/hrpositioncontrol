<!DOCTYPE html>
<html>
<head>
<title>Landing</title>
<link rel="stylesheet" href="css/landing.css">
</head>
<body>
<label class="custom-select" for="selectVersion">
    <select id="selectVersion">
    <option value="">
      Select an version
    </option>
  </select>
</label>
<button id="btn-open">Open</button>
<button id="btn-delete">Delete</button>
<button id="btn-extrac">Open from extrac</button>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript">
  $(document).ready(function(){

  var versions;
  $.ajax({
    url: "php/pick_version.php",
    data: null,
    type: 'POST',
    dataType: "json",
    success: function(output) {
        console.log ('getversion output:' + output);
        versions = output;
      },
      error: function(xhr, status, error){
        alert ('error: ' + error + '; status=' + status);
      },
      async:false
    });

    var dropdown = document.getElementById("selectVersion");
    for (var i=0;i<versions.length; i++){
      // var time = versions[i]['time'].toString().trim();
      // var version_name = versions[i]['version_name'].toString().trim();
      // var owner = versions[i]['owner'].toString().trim();
      var version_id = versions[i]['version_id'];
      var option = document.createElement("option");
      // option.text =  time+ ' '+ version_name + ' '+ owner;
      // option.value = version_name;
      option.text = 'version #' + version_id;
      option.value = version_id;
      dropdown.append(option);
    }

    // change listener for select head drop-down list
    // $('#selectVersion').on('change', function() {
    //    var version_id = document.getElementById("selectVersion").value;
    //    sessionStorage.setItem("sent", version_id);
    //    window.open("http://localhost/hrpositioncontrol/OrgChart-master/demo/lacounty.html","_blank");
    // });

    $('#btn-extrac').on('click', function() {
      window.open("http://localhost/hrpositioncontrol/OrgChart-master/demo/lacounty.html","_blank");
    });
    $('#btn-open').on('click', function() {
      var version_id = document.getElementById("selectVersion").value;
      sessionStorage.setItem("sent", version_id);
      window.open("http://localhost/hrpositioncontrol/OrgChart-master/demo/lacounty.html","_blank");
    });

    $('#btn-delete').on('click', function() {
      var version_id = document.getElementById("selectVersion").value;
      var x = document.getElementById("selectVersion");
      x.remove(x.selectedIndex);
      var myData = {
        'version_id': version_id
      };
      $.ajax({
        url: "php/delete_version.php",
        data: myData,
        type: 'POST',
        dataType: "text",
        success: function(output) {

          },
          error: function(xhr, status, error){
            alert ('error: ' + error + '; status=' + status);
          },
          async:false
        });
    });

  });
</script>

</body>
</html>
